<?php //header('Content-type: text/html; charset=utf-8');
set_error_handler('err_handler');
function err_handler($errno, $errmsg, $filename, $linenum) {
$date = date('Y-m-d H:i:s (T)');
$f = fopen('errors_bot.txt', 'a');
if (!empty($f)) {
$filename  =str_replace($_SERVER['DOCUMENT_ROOT'],'',$filename);
$err  = "$date = $errmsg = $filename = $linenum\r\n";
fwrite($f, $err);
fclose($f);
}
}

require_once 'classes/PDO.php';					// –ø–æ–¥–∫–ª—é—á–∞–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
require_once 'classes/function.php'; 			// —Ñ—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
require_once 'classes/getParserResponse.php';	// –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –∫–æ–º–∞–Ω–¥
require_once 'classes/FMSOut.php'; 	 			// –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Å–ø–æ—Ä—Ç–æ–≤
require_once 'classes/getWebHook.php';					// –ö–ª–∞—Å—Å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Ç–µ–ª–µ–≥—Ä–∞–º–º 


		/**
	* –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
	**/
	$botToken  = " "; // —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —Ç–µ–ª–µ–≥—Ä–∞–º–º
	$maxCheckPass = '10';  		// –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º–æ–µ –∫–æ–ª-–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
	$timeOutCheck = '180'; 		// –í—Ä–µ–º–µ–Ω–Ω–æ–π —Ç–∞–π–º-–∞—É—Ç –º–µ–∂–¥—É –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
	$adminId = ;		//1618426159 -> id @kravchukk
	
	/**
	*
	*–ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
	*–ü—Ä–∏–Ω–∏–º–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Ç –¢–µ–≥–µ—Ä–∞–º–º –≤ –≤–∏–¥–µ WebHook
	*–ù–∞—Å—Ç—Ä–æ–∫—É WebHook –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ —Ñ–∞–π–ª SetWebHook —É–∫–∞–∑–∞–≤ —Ç–∞–º –¥–∞–Ω–Ω—ã–µ: —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ —Ç–µ–ª–µ–≥—Ä–∞–º–º.
	**/
	$WebHook= new getWebHook();
	$action = $WebHook->init('php://input');
		
		
		
	//**********************************************************************************
	//****************** –ó–∞–¥–∞—ë–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–º –æ—Ç –¢–µ–ª–µ–≥—Ä–∞–º–º     *********************
	//**********************************************************************************

	$message	= $action["message"];
	$chat_id	= $action["chat_id"];
	
	if($action["replyid"]){$reply_id	= $action["replyid"];}
	if($action["data"]){$data = $action["data"];}
	if($action["call_id"]){$call_id	= $action["call_id"];}
	

	//**********************************************************************************
	//*********************** –ù–∞—á–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞    ********************************
	//**********************************************************************************


	/**
	*	–°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ —é–∑–µ—Ä—É –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
	**/
	$user = DB::$the->query("SELECT * FROM `tlg_passCheck_user` WHERE `chat_id` = ".$chat_id."");
	$user = $user->fetch(PDO::FETCH_ASSOC);

	
	/**
	*	–û–±—ä—è–≤–ª—è–µ–º –∫–ª–∞—Å—Å –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞
	**/
	$ParserResponse = new getParserResponse();	

	
	/**
	* 	–ö–æ–º–∞–Ω–¥–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–º
	**/
	$SenDTo = $ParserResponse->SendTo($botToken, $chat_id);

	
	/**
	*	–°–æ–∑–¥–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
	**/
	$ParserResponse->persona($chat_id);

	
	/**
	* 	–ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫
	**/
	$start		= $user['startcheck'];
	$timeout 	= ($start + $timeOutCheck);
	
	
	/**
	* 	–ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª-–≤–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —é–∑–µ—Ä–∞
	**/
	$LastCountCcheck = $user['count_check'];
	$Admine = $ParserResponse->isAdmine();
	$commands = $user['commands']; 
	//**********************************************************************************
	//*********************** –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –Ω–∞  –æ—Ç–∑—ã–≤  ********************************
	//**********************************************************************************
	
	
	/**
	* 	–ó–∞–¥–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ç–∞—Ç—É—Å—É
	*/
	$status = $user['status']; 
	
	/**
	*	–ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å callback_query –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å –Ω–∞–∂–∞—Ç–æ–π –∫–Ω–æ–ø–∫–∏
	* 	–ø—Ä–∏–¥—ë—Ç: reply- - –ø—Ä–µ—Ñ–∏–∫—Å
	*			id_user - –∫–æ–º—É –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω –æ—Ç–≤–µ—Ç. –ü–æ–ª—É—á–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å —Ñ—É–Ω–∫—Ü–∏–∏ msgfeedBackAdmin
	*
	*/
	$datain = explode("-", $data);
	
	if ($datain[0] == "reply" AND $status == NULL AND $chat_id == $adminId)
	{
		DB::$the->prepare("UPDATE tlg_passCheck_user SET status=? WHERE chat_id=? ")->execute(array("reply-". $datain[1]."",  $chat_id));
		$messageText = "*–ù–∞–ø–∏—Å–∞—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –æ—Ç–∑—ã–≤:*";
		return $SenDTo->sendMessageAdmin($messageText);
		exit('ok');
	}
	
	/**
	*	–û–±—Ä–µ–∑–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Å—Ç–∞—Ç—É—Å) –∏ —Å—á–∏—Ç—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–º—É –æ—Ç–≤–µ—á–∞—Ç—å
	*/
	$sexploded = explode("-", $status);
	
	if($sexploded[0] == "reply" AND $chat_id == $adminId)
	{
		$chatuser = $sexploded[1];
	
		DB::$the->prepare("UPDATE tlg_passCheck_user SET status=? WHERE chat_id=? ")->execute(array(NULL,  $chat_id));
		$SenDTo->sendMessageCallBackUser($chatuser, $message);
		exit('ok');
	} 
	
	/**
	* 	–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å! –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ msgFeedback
	*	–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–∑—ã–≤–∞ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å feedback 
	*	–ü–æ –∏—Ç–æ–≥—É –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π: 
	*			-- –Æ–∑–µ—Ä—É —Å –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é
	*			-- –° –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—Ç–∑—ã–≤–∞ –∏ –∫–Ω–æ–ø–∫–æ–π Repley –¥–ª—è –æ—Ç–≤–µ—Ç–∞
	*/
	if($user['status'] == "feedback"){

		if($message == "–û—Ç–º–µ–Ω–∞ ‚ùå")
		{
			DB::$the->prepare("UPDATE tlg_passCheck_user SET status=? WHERE chat_id=? ")->execute(array(NULL,  $chat_id));		
			$messageText = "–æ—Ç–º–µ–Ω–µ–Ω–æ ‚ùå";
			$buttonKeyboard[] = array("‚ùî –°–ø—Ä–∞–≤–∫–∞", "üëâ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Å–ø–æ—Ä—Ç");	
			$buttonKeyboard[] = array("–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å üì´");	
			return $SenDTo->sendMessageUser($messageText, $buttonKeyboard);

		}else{
			$name = $ParserResponse->persona($chat_id);
			return $ParserResponse->msgfeedBackAdmin($call_id, $message, $name, $username, $id_user, $adminId);
			
		}
		exit('ok');
	}
	
	//**********************************************************************************
	//**********************************************************************************
	//**********************************************************************************
	
	
	
	//******************   –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–π –≥—Ä—É–ø–ø—ã —Ñ—É–Ω–∫—Ü–∏–∏ *************************
	//**********************************************************************************
	
	
	/**
	*	–†–∞–±–æ—Ç–∞ –¥–ª—è –∞–¥–º–∏–Ω –≥—Ä—É–ø–ø—ã
	**/
	if($Admine == 'yes')
	{	
		if($commands == 'check')
		{
			if($message == "–û—Ç–º–µ–Ω–∞ ‚ùå" or $message == "üîô –ù–∞–∑–∞–¥")
			{
				DB::$the->prepare("UPDATE tlg_passCheck_user SET commands=? WHERE chat_id=? ")->execute(array(NULL, $chat_id));
				
				$messageText 	 	= "–æ—Ç–º–µ–Ω–µ–Ω–æ ‚ùå";
				$buttonKeyboard[] 	= array("‚ùî –°–ø—Ä–∞–≤–∫–∞", "üëâ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Å–ø–æ—Ä—Ç");	
				$buttonKeyboard[] 	= array("–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å üì´");	
				
				$SenDTo->sendMessageUser($messageText, $buttonKeyboard);
				exit;
			}

			$CheckPassMax = '20';  // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º–æ–µ –∫–æ–ª-–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
			DB::$the->prepare("UPDATE tlg_passCheck_user SET commands=? WHERE chat_id=? ")->execute(array(NULL,  $chat_id));
			$CheckPassisAdmine = new FMSOut($message, $botToken, $chat_id);		
			// –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª=–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
			$CountPassAdmin = $CheckPassisAdmine->isCountPass();			
			
			
			/**
			* –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –ø—Ä–∏–≤—ã—à–µ–∫–Ω–æ –ª–∏ –∫–æ–ª-–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ
			* –µ—Å–ª–∏ –Ω–µ—Ç, —Ç–æ
			*/
			if($CountPassAdmin <= $CheckPassMax)
			{
				DB::$the->prepare("UPDATE tlg_passCheck_user SET commands=? WHERE chat_id=? ")->execute(array(NULL,  $chat_id));

				//–ø—Ä–∏–±–∞–≤–ª—è–µ–º –∫–æ–ª-–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –Ω–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ 
				$CountCcheckAdmine = $LastCountCcheck + $CountPassAdmin;
				
				//	–û–±–Ω–æ—ã–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–ª-–≤–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–∞—Å–ø–æ—Ä—Ç–æ–≤
				DB::$the->prepare("UPDATE tlg_passCheck_user SET  count_check=? WHERE chat_id=? ")->execute(array($CountCcheckAdmine, $chat_id));	
				//	—Å—Ç–∞—Ç—É—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–µ–ª–≤–µ–º 1
				
				//	–ó–∞–¥–∞–µ–º –≤—Ä–µ–º—è —Å—Ç–∞—Ä—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Å–ø–æ—Ä—Ç–æ–≤				
				DB::$the->prepare("UPDATE tlg_passCheck_user SET startcheck=? WHERE chat_id=? ")->execute(array(time(), $chat_id));	
				
				// –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –±–æ—Ç–∞				
				
				// –¢–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏				
				$messageTextAdmine = "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –≥—Ä—É–ø–ø–∞
				üìã –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: <b>".$CountPassAdmin."</b> .\xE2\x8F\xB3 –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ.\xE2\x8F\xB3";
				
				// –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–º –æ—Ç–≤–µ—Ç				
				$ToisAdmine = $SenDTo->sendMessageUser($messageTextAdmine, 	$remove_keyboard = false);
				$SenDTo->ChatAction();
				
				/**
				*	–ï–°–õ–ò –°–û–û–ë–©–ï–ù–ò–ï –û –ö–û–õ-–í–û –î–û–ö–£–ú–ï–ù–¢–û–í –î–û–°–¢–ê–í–õ–ï–ù–û –í –¢–ï–õ–ï–ì–†–ê–ú–ú –¢–û –ü–†–û–í–ï–†–Ø–ï–ú –î–ê–õ–¨–®–ï
				*/
				if($ToisAdmine['ok'] == 1)
				{
					
					// –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ –º–∞—Å—Å–∏–≤–æ–≤ —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–∞–∂–¥—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
					$PassInfoArryAdmine = $CheckPassisAdmine->PassinfoArr();
					
					// 	–†–∞–∑–±—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π –º–∞—Å—Å–∏–≤ –Ω–∞ —á–∞—Å—Ç–∏: —Å–µ—Ä–∏—è –∏ –Ω–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞
					$arrPassInAdmine = $CheckPassisAdmine->getPassCheckInfo();
			
					// 
					$SenDTo->ChatAction();	
					// –î–µ–ª–∞–µ–º –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–∞—Å–ø–æ—Ä—Ç–æ–≤ –∏ –æ—Ç—Å—ã–ª–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ—ë –ø—Ä–æ–≤–µ—Ä–∫–µ
					$TextisAdmine = $CheckPassisAdmine->isCheckPass($CountPassAdmin, $arrPassInAdmine);
				
					
				exit;
			
				}
				
			exit;
		
			}
		exit;
		}
	
	}


	
	//***********************************   –î–ª—è –Æ–ó–ï–†–û–í —Ñ—É–Ω–∫—Ü–∏–∏ *************************
	//**********************************************************************************
	/**
	*	–ü—Ä–æ–≤–µ—Ä—è–µ–º –±—ã–ª–∞ –ª–∏ –ø—Ä–∏–Ω—è—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –æ–∂–∏–¥–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –∑–∞–ø–∏—Å–∞–Ω–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
	*
	**/
	if($commands == 'check')
	{	
	
		/**
		*	–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫. –ï—Å–ª–∏ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ—à–ª–æ –º–µ–Ω—å—à–µ —á–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–æ, —Ç–æ
		*	—é–∑–µ—Ä—É –æ—Ç—Å—ã–ª–∞–µ–º –æ—Ç–∫–∞–∑
		**/
		if($timeout > time())
		{
			//	–û–±–Ω—É–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö
			DB::$the->prepare("UPDATE tlg_passCheck_user SET commands=? WHERE chat_id=? ")->execute(array(NULL,  $chat_id));		
			// 	–í—ã—Å—á–∏—Ç—ã–≤–∞–µ–º –º–∏–Ω—É—Ç—ã –∏–∑ —Å–µ–∫—É–Ω–¥
			$minuyes = $timeOutCheck/60;	
			// –¢–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
			$messageText = "–ü—Ä–æ—Å—Ç–∏—Ç–µ, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∫—É –º–æ–∂–Ω–æ —Å–æ–≤–µ—Ä—à–∞—Ç—å 1 —Ä–∞–∑ –≤ ".$minuyes." –º–∏–Ω—É—Ç –≤ –∫–æ–ª-–≤–µ ".$maxCheckPass." –ø–∞—Å—Å–ø–æ—Ä—Ç–æ–≤ –∑–∞ –∑–∞–ø—Ä–æ—Å. –î–∞–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤–≤–µ–¥–µ–Ω—ã –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ —Ü–µ–ª—è—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞.";
			// –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –±–æ—Ç–∞
			$buttonKeyboard2[] = array("‚ùî –°–ø—Ä–∞–≤–∫–∞", "üëâ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Å–ø–æ—Ä—Ç");	
			// –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–º –æ—Ç–≤–µ—Ç			
			$SenDTo->sendMessageUser($messageText, $buttonKeyboard2);
			
			exit;
	
		}

		/**
		* –ü—Ä–æ–≤–µ—Ä—è–µ–º  –ø—Ä–æ—à–ª–æ –ª–∏ –≤—Ä–µ–º–µ–Ω–∏  –±–æ–ª—å—à–µ —á–µ–º —Ç–∞–π–º–∞—É—Ç
		*/
		if($timeout < time())
		{
			
			if($message == "–û—Ç–º–µ–Ω–∞ ‚ùå" or $message == "üîô –ù–∞–∑–∞–¥")
			{
				DB::$the->prepare("UPDATE tlg_passCheck_user SET commands=? WHERE chat_id=? ")->execute(array(NULL,  $chat_id));
				$messageText = "–æ—Ç–º–µ–Ω–µ–Ω–æ ‚ùå";
				$buttonKeyboard[] = array("‚ùî –°–ø—Ä–∞–≤–∫–∞", "üëâ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Å–ø–æ—Ä—Ç");	
				$buttonKeyboard[] = array("–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å üì´");	
				$SenDTo->sendMessageUser($messageText, $buttonKeyboard);
				exit;
			}
			else
			{			
				//	–û–±–Ω—É–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö
				DB::$the->prepare("UPDATE tlg_passCheck_user SET commands=? WHERE chat_id=? ")->execute(array(NULL,  $chat_id));
				// –û–±—è—ä–≤–ª—è–µ–º –∫–ª–∞—Å—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö
				$CheckPass = new FMSOut($message, $botToken, $chat_id);		
				// –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª=–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
				$CountPass = $CheckPass->isCountPass();						

				/**
				* –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –ø—Ä–∏–≤—ã—à–µ–∫–Ω–æ –ª–∏ –∫–æ–ª-–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ
				* –µ—Å–ª–∏ –Ω–µ—Ç, —Ç–æ
				*/
				if($CountPass <= $maxCheckPass)
				{
					//–ø—Ä–∏–±–∞–≤–ª—è–µ–º –∫–æ–ª-–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –Ω–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ 
					$CountCcheck = $LastCountCcheck + $CountPass;
					//	–û–±–Ω–æ—ã–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ –∫–æ–ª-–≤–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø–∞—Å–ø–æ—Ä—Ç–æ–≤
					DB::$the->prepare("UPDATE tlg_passCheck_user SET  count_check=? WHERE chat_id=? ")->execute(array($CountCcheck, $chat_id));	
					//	–ó–∞–¥–∞–µ–º –≤—Ä–µ–º—è —Å—Ç–∞—Ä—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Å–ø–æ—Ä—Ç–æ–≤				
					DB::$the->prepare("UPDATE tlg_passCheck_user SET startcheck=? WHERE chat_id=? ")->execute(array(time(), $chat_id));	
					
					// –¢–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏				
					$messageText1 = "üìã –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: <b>".$CountPass."</b> . –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ.";
					
					// –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–º –æ—Ç–≤–µ—Ç				
					$To = $SenDTo->sendMessageUser($messageText1, false, false, false, true);
					$SenDTo->ChatAction();
					
				
					/**
					*	–ï–°–õ–ò –°–û–û–ë–©–ï–ù–ò–ï –û –ö–û–õ-–í–û –î–û–ö–£–ú–ï–ù–¢–û–í –î–û–°–¢–ê–í–õ–ï–ù–û –í –¢–ï–õ–ï–ì–†–ê–ú–ú –¢–û –ü–†–û–í–ï–†–Ø–ï–ú –î–ê–õ–¨–®–ï
					*/
					if($To['ok'] == 1)
					{
						
						// –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ –º–∞—Å—Å–∏–≤–æ–≤ —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–∞–∂–¥—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
						$PassInfoArry = $CheckPass->PassinfoArr();
						// 	–†–∞–∑–±—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π –º–∞—Å—Å–∏–≤ –Ω–∞ —á–∞—Å—Ç–∏: —Å–µ—Ä–∏—è –∏ –Ω–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞
						$arrPassIn = $CheckPass->getPassCheckInfo();
						// 
						$SenDTo->ChatAction();	
						// –î–µ–ª–∞–µ–º –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–∞—Å–ø–æ—Ä—Ç–æ–≤ –∏ –æ—Ç—Å—ã–ª–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –¥–∞–Ω–Ω—ã–µ –æ –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω–æ—ë –ø—Ä–æ–≤–µ—Ä–∫–µ
						$Text = $CheckPass->isCheckPass($CountPass, $arrPassIn);
						
					exit;
				
					}
					
				exit;
			
				}
				
			
				else //–ï—Å–ª–∏ –∫–æ–ª-–≤–æ –±–æ–ª—å—à–µ —á–µ–º –¥–æ–ø—É—Å—Ç–∏–º–æ–µ
				{
					// –¢–µ–ª–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏	
					$messageText = "–ü—Ä–æ—Å—Ç–∏—Ç–µ, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∫—É –º–æ–∂–Ω–æ —Å–æ–≤–µ—Ä—à–∞—Ç—å 1 —Ä–∞–∑ –≤ ".$minuyes." –º–∏–Ω—É—Ç –≤ –∫–æ–ª-–≤–µ ".$maxCheckPass." –ø–∞—Å—Å–ø–æ—Ä—Ç–æ–≤ –∑–∞ –∑–∞–ø—Ä–æ—Å. –î–∞–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤–≤–µ–¥–µ–Ω—ã –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ —Ü–µ–ª—è—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞.";
					
					// –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –±–æ—Ç–∞		
					$buttonKeyboard2[] = array("‚ùî –°–ø—Ä–∞–≤–∫–∞", "üëâ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Å–ø–æ—Ä—Ç");
					// –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–º –æ—Ç–≤–µ—Ç				
					$SenDTo->sendMessageUser($messageText, $buttonKeyboard2);
					exit;
			
				}
			
			exit;
			}
		
		exit;
	
		}
		
		
		
	
	}
	
	
	//	–û–±–Ω—É–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö
	DB::$the->prepare("UPDATE tlg_passCheck_user SET commands=? WHERE chat_id=? ")->execute(array(NULL,  $chat_id));
	
	
	/**
	*	–ü–∞—Å—Ä—Å–∏–º –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
	*/
	$ParserResponse->parser($message);


teleToLog($action);	
exit;

?>